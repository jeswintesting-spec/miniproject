<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CUCEK Labs - Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-100 font-[Inter] text-gray-800">

  <!-- Header -->
<header class="bg-white shadow-md sticky top-0 z-50">
  <nav class="container mx-auto px-6 py-3 flex justify-between items-center">
    <a href="../backkk.html" class="text-2xl font-bold text-teal-600 hover:text-teal-700 transition-colors">
      CUCEK Labs Dashboard
    </a>
  </nav>
</header>


  <!-- Main -->
  <main class="container mx-auto px-6 py-8">
    <h2 class="text-3xl font-bold mb-6 text-gray-800 text-center">Live Lab Status</h2>

    <!-- Labs Grid -->
    <div id="labs-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      <div class="col-span-full text-center p-10 text-gray-500"><p>Loading labs...</p></div>
    </div>

    <p class="text-center text-gray-500 text-sm mt-8">Auto-refreshes every 30 seconds</p>
  </main>

  <script>
    const API_URL = 'api.php';
    const labsContainer = document.getElementById('labs-container');

    // Fetch and display labs
    async function fetchLabs() {
      try {
        const response = await fetch(API_URL);
        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
        const labs = await response.json();
        renderLabs(labs);
      } catch (error) {
        console.error('Error fetching labs:', error);
        labsContainer.innerHTML = `
          <div class="bg-red-100 text-red-700 p-4 rounded-lg text-center">
            Failed to load labs. Please check your connection.
          </div>`;
      }
    }

    // Render lab cards with emojis
    function renderLabs(labs) {
      labsContainer.innerHTML = '';
      if (Object.keys(labs).length === 0) {
        labsContainer.innerHTML = `<p class="text-center text-gray-500 col-span-full">No labs found.</p>`;
        return;
      }

      Object.values(labs).forEach(lab => {
        // Status emoji
        const statusEmoji = lab.status === 'Open' ? 'üü¢' : 'üî¥';
        const statusColor = lab.status === 'Open' ? 'bg-green-100 text-green-800 border-green-400' : 'bg-red-100 text-red-800 border-red-400';
        
        // Crowd emoji
        const crowdEmoji = lab.crowd === 'Low' ? 'üôÇ' : lab.crowd === 'Moderate' ? 'üòê' : 'üòì';
        const crowdColor = lab.crowd === 'Low' ? 'text-green-600' : lab.crowd === 'Moderate' ? 'text-yellow-600' : 'text-red-600';

        // Lab type emoji (optional)
        let labEmoji = 'üß™'; // Default lab emoji
        if (lab.type) {
          if (lab.type.toLowerCase().includes('computer')) labEmoji = 'üíª';
          else if (lab.type.toLowerCase().includes('physics')) labEmoji = '‚öõÔ∏è';
          else if (lab.type.toLowerCase().includes('chemistry')) labEmoji = 'üß™';
          else if (lab.type.toLowerCase().includes('biology')) labEmoji = 'üß¨';
        }

        const card = `
          <div class="bg-white p-6 rounded-lg shadow-md border border-gray-200 hover:shadow-lg transition-shadow">
            <h3 class="text-xl font-semibold text-teal-700 mb-3">${labEmoji} ${lab.name} ${statusEmoji}</h3>

            <div class="flex items-center justify-between mb-3">
              <span class="font-medium">Status:</span>
              <span class="px-3 py-1 rounded-full border ${statusColor}">${lab.status}</span>
            </div>

            <div class="flex items-center justify-between mb-3">
              <span class="font-medium">Crowd Level:</span>
              <span class="${crowdColor} font-semibold">${lab.crowd} ${crowdEmoji}</span>
            </div>

            <div class="mt-3">
              <span class="font-medium block mb-1">Upcoming Event:</span>
              <p class="text-gray-700 text-sm">${lab.event ? lab.event : '<em>No upcoming events</em>'}</p>
            </div>
          </div>
        `;
        labsContainer.innerHTML += card;
      });
    }

    // Initial load
    document.addEventListener('DOMContentLoaded', fetchLabs);

    // Auto-refresh every 30 seconds
    setInterval(fetchLabs, 30000);
  </script>

</body>
</html>
